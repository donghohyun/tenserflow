# 이미지 분류보델을 이용한 포켓몬 이미지 유사도 분석

----
## cli를 이용한 변수선언

1) -a
* 유사도를 모든캐릭터에 대한 값을 확인할지(all), 특정캐릭터와 유사한 상위 캐릭터를 그림과 함께 확인할지(one) 설정가능
* default -> all
* all, one 중 설정 가능
2) -n
* -a 값을 one으로 설정시 적용되며, 해당값에 원하는 캐릭터 입력시 해당캐릭터와 유사도가 높게 나온 10개의 캐릭터에 대해 확인 가능하다
* default -> "abomasnow"
* 데이터에 있는 캐릭터 이름 전부 가능
3) -f
* 같은 데이터를 입력하였을때 반복해서 예측값을 구하는것을 막기위해 예측값을 저장하는 이름에 해당된다.
* 지정한 값이 predict_data에 없다면 모델예측값 구하여 새로 저장하고, predict_data에 있는 변수를 입력한다면 저장되어있는 예측값을 바탕으로 결과를 도출하게된다.
* 해당 변수 미지정시 매 실행마다 모델학습이 진행됨(시간이 오래걸릴수 있음)

---
## 주요 기능 소개
1. 이미지를 전처리 한 후 사전학습된 모델인 VGG16모델을 이용하여 예측값을 구한다.
    * 이미지를 rgb영역으로 변환
    * 모든 이미지 사이즈를 동일하게 변환
    * 이미지를 배열형태로 변환
2. 예측된 결과를 이용하여 코싸인 유사도를 구한다.
3. 사용자가 원하는 결과물(전체 유사도, 특정캐릭터와 유사한 캐릭터)를 출력한다.

## 결과물
---
1) 모든 변수를 default값으로 지정하였을 경우
  * 캐릭터 default 값인 'abomasnow'와 유사한 상위 10개 캐릭터들의 이미지가 유사도와 함께 표시됨
  <p align="center">
    <img src="https://github.com/donghohyun/predictive-modeling/assets/139213175/a9054189-2670-4428-b02e-6515276993fc" weight = 500>
  </p>
  
2) a값을 'all'로 주었을 경우
  * 모든 이미지간 유사도 결과가 표시됨
  <p align="center">
    <img src="https://github.com/donghohyun/predictive-modeling/assets/139213175/a676c496-7443-4620-9c7d-1d4e044f11db" weight = 500>
  </p>

## 결론 및 고찰
---
* 이미지를 전처리 할 때 기존의 이미지에서 캐릭터가 차지하는 영역을 고려하지 않고 이미지 전체 사이즈만을 동일한 사이즈로 변경해주어 실제 이미지 사이즈가 제각각으로 되어있을 가능성을 고려하지 못하였다. (차후 파일에서 캐릭터가 있는 영역을 기준으로 이미지 파일을 크롭한 뒤 이미지 사이즈를 동일하게 맞출 필요가 있어 보인다.)
* batch_one_all값을 'one'으로 설정 시 원하는 캐릭터와 유사한 상위 10개의 이미지를 나타내고 있지만 육안으로 확인하였을때 이미지간 유사도가 비슷하지 않은 것들도 많이 추천되는 것을 볼 수 있었다.
* 결과를 확인할 때 육안으로만 이미지가 비슷한지 확인하였는데 제공된 csv파일의 type을 확인해보며 실제로 유사한 이미지인지 확인하여 유사한 이미지인지 검증하는 과정이 추가되어야 할 것 같다.
* 현재 상위 10개 캐릭터들에 대해 이미지가 나타나는데 일정값 이상인 캐릭터들로 한정하여 이미지를 표시해 주는것이 더 바람직 하다 생각된다.
